version: 2

models:
  - name: mart_movie_monthly_performance
    description: >
      Final fact model that merges monthly revenue data from all Silver Screen locations
      with enriched invoice and movie catalogue details.
      The model joins aggregated revenue data (int_nj_monthly_rev)
      with detailed sales and movie information (int_invoices_enriched)
      on movie_id, location_id, and month.
      Each record represents a movieâ€™s performance at a specific location and month,
      including ticket sales, revenue, rental costs, and calculated gross margin.
      This design ensures that only movies with recorded sales are included,
      providing a reliable basis for profitability analysis.
    columns:
      - name: movie_id
        data_type: varchar
        description: >
          Unique identifier for the movie, used to join revenue and movie details.
        tests:
          - not_null

      - name: movie_title
        data_type: varchar
        description: >
          Title of the movie, taken from the movie catalogue.

      - name: genre
        data_type: varchar
        description: >
          Genre classification of the movie, with 'Unknown' for missing entries.

      - name: studio
        data_type: varchar
        description: >
          Studio responsible for the movie.

      - name: month
        data_type: date
        description: >
          Reporting month for the aggregated metrics (derived using DATE_TRUNC in earlier models).

      - name: location_id
        data_type: varchar
        description: >
          Identifier of the Silver Screen theater location ('nj_001', 'nj_002', 'nj_003').

      - name: total_tickets_sold
        data_type: number
        description: >
          Total number of tickets sold for the movie at the location during the given month.

      - name: total_revenue
        data_type: number
        description: >
          Total ticket sales revenue for the movie at the location during the given month.

      - name: total_price
        data_type: number
        description: >
          Monthly rental cost for showing the movie at the location.

      - name: gross_margin
        data_type: number
        description: >
          Gross margin calculated as (total_revenue - total_price) / total_revenue.
          Represents the share of profit relative to revenue, rounded to two decimals.
          Negative values indicate unprofitable movie performances where rental costs
          exceeded ticket revenue.
